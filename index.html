<!DOCTYPE html>
<html>
<head>
  <title>Stock Viewer</title>
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background: #f4f4f4; }
    input { margin: 10px 0; padding: 8px; width: 300px; }
  </style>
</head>
<body>
  <h1>Stock Viewer</h1>
  <input type="text" id="filter" placeholder="Filter by name or symbol..." />
  <table id="table"></table>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <script>
    const table = document.getElementById("table");
    const filterInput = document.getElementById("filter");

    let data = [];

    Papa.parse("daily_market_capitalization.csv", {
      download: true,
      header: true,
      complete: (results) => {
        data = results.data;
        render(data);
      }
    });

    filterInput.addEventListener("input", () => {
      const filter = filterInput.value.toLowerCase();
      const filtered = data.filter(
        row => row.name?.toLowerCase().includes(filter) || row.symbol?.toLowerCase().includes(filter)
      );
      render(filtered);
    });

    function render(rows) {
      if (!rows.length) return table.innerHTML = "<tr><td>No data</td></tr>";

      const headers = Object.keys(rows[0]);
      table.innerHTML = `
        <thead><tr>${headers.map(h => `<th>${h}</th>`).join("")}</tr></thead>
        <tbody>
          ${rows.map(r => `<tr>${headers.map(h => `<td>${r[h]}</td>`).join("")}</tr>`).join("")}
        </tbody>
      `;
    }
  </script>
</body>
</html>
